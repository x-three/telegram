!function(t){var i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(s,n,function(i){return t[i]}.bind(null,n));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="/",e(e.s=0)}([function(t,i,e){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,i,e){var s=document.createElement(i);return s.className=e||"",t.appendChild(s)}function a(t,i){var e,s,n,a,o=function(t){return{x:t.pageX,y:t.pageY,sx:e,sy:s,ox:n,oy:a}},h=function(i){var o=t.getBoundingClientRect();e=i.pageX,s=i.pageY,n=i.clientX-o.left,a=i.clientY-o.top},r=function t(e){document.removeEventListener("touchmove",u),document.removeEventListener("touchend",t),i("end",o(e.changedTouches[0]))},l=function t(e){document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",t),i("end",o(e))},u=function(t){i("move",o(t.touches?t.touches[0]:t))};t.addEventListener("mousedown",function(t){1===t.which&&(t.stopPropagation(),t.preventDefault(),h(t),i("start",o(t)),document.addEventListener("mousemove",u),document.addEventListener("mouseup",l))}),t.addEventListener("touchstart",function(t){t.stopPropagation(),t.preventDefault(),1===t.touches.length?(h(t.touches[0]),i("start",o(t.touches[0])),document.addEventListener("touchmove",u),document.addEventListener("touchend",r)):r(t)})}function o(t){var i=t.getBoundingClientRect();return{left:window.pageXOffset+i.left,top:window.pageYOffset+i.top}}function h(t){if("#"===t[0])return/^#[0-9a-z]+$/i.test(t)&&-1!==[4,5,7,9].indexOf(t.length)?(t.length<=5&&(t=t.replace(/([0-9a-z])/gi,"$1$1")),{r:parseInt(t.substring(1,3),16),g:parseInt(t.substring(3,5),16),b:parseInt(t.substring(5,7),16),a:t.length<=7?1:parseInt(t.substring(7,9),16)/255}):null;var i=/^rgba?\(([0-9]+), ?([0-9]+), ?([0-9]+)(?:, ?(1|0|0\.[0-9]+))?\)$/i.exec(t);return i?{r:+i[1],g:+i[2],b:+i[3],a:void 0!==i[4]?+i[4]:1}:null}function r(t,i){return i=t.a*(null!=i?i:1),"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(i,")")}function l(t){for(var i=arguments.length,e=new Array(i>1?i-1:0),s=1;s<i;s++)e[s-1]=arguments[s];return c(1,t,e)}function u(t){for(var i=arguments.length,e=new Array(i>1?i-1:0),s=1;s<i;s++)e[s-1]=arguments[s];return c(null,t,e)}function c(t,i,e){if(!(i instanceof Object))throw"Invalid Target Object";return e.length?e.reduce(function(i,e){return e instanceof Object&&(!(e instanceof Array)||i instanceof Array)?function t(i,e,n,a){for(var o in e){var h=e[o]instanceof Array?"array":s(e[o]),r=i[o]instanceof Array?"array":s(i[o]);!(null==a||n<a)||"array"!==h&&"object"!==h?i[o]=e[o]:(h!==r&&(i[o]="array"===h?[]:{}),t(i[o],e[o],n+1,a))}return i}(i,e,1,t):i},i):i}function f(t,i){for(var e in t)if(t.hasOwnProperty(e)&&i(t[e],isNaN(+e)?e:+e,t))return t[e]}function d(){return Math.min(2,window.devicePixelRatio)}e.r(i),function(){if("function"==typeof window.CustomEvent)return!1;function t(t,i){i=u({bubbles:!1,cancelable:!1,detail:void 0},i);var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),e}t.prototype=window.Event.prototype,window.CustomEvent=t}();var p={visible:{y0:!0,y1:!0,y2:!0,y3:!0},fx:{duration:350,easing:"easeOutQuad"},localization:{days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],separator:{decimal:".",thousand:" "},suffixes:["K","M","G","T"]},font:{family:"Arial, sans-serif",size:15,hLetter:1/1.4,weight:400,color:"#697d8cb2"},columns:{start:0,min:13,adaptive:606},chart:{color:{hLine:"#61788514",vLine:"#809baf40"},thickness:{graph:3,grid:1.5},margin:{top:32,bottom:28},labelVOffset:{left:9,bottom:9},tails:!0},preview:{thickness:1.5,margin:5},tooltip:{crossingRadius:6,offset:37}},g={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return 1-g.easeInQuad(1-t)},easeInOutQuad:function(t){return t<.5?g.easeInQuad(2*t)/2:g.easeOutQuad(2*t-1)/2+.5},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1-g.easeInCubic(1-t)},easeInOutCubic:function(t){return t<.5?g.easeInCubic(2*t)/2:g.easeOutCubic(2*t-1)/2+.5},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1-g.easeInQuart(1-t)},easeInOutQuart:function(t){return t<.5?g.easeInQuart(2*t)/2:g.easeOutQuart(2*t-1)/2+.5},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1-g.easeInQuint(1-t)},easeInOutQuint:function(t){return t<.5?g.easeInQuint(2*t)/2:g.easeOutQuint(2*t-1)/2+.5}};function v(t){Object.defineProperties(this,{_cb:{value:t},_rafId:{value:null,writable:!0}})}Object.defineProperties(v.prototype,{add:{value:function(t,i){this[t]=l({},i)}},addFx:{value:function(t,i,e,s,n,a,o){var h=this[t]||(this[t]={});if(null!=i){for(var r in h)delete h[r];l(h,i)}else delete h.fx;h.fx={start:Date.now(),duration:n||0,easing:g[a]?a:"linear",destroy:null!=o?o:1===arguments.length||!Object.keys(h).length},void 0!==e&&void 0!==s&&l(h.fx,{from:e,to:s,time:0,pos:0});this._start()}},removeFx:{value:function(t,i){for(var e in this)e!==t&&0!==e.indexOf(t+":")||(i?delete this[e]:delete this[e].fx)}},clearFx:{value:function(t){for(var i in this){var e=this[i].fx;e&&(null==t||t>=e.start+e.duration)&&(e.destroy?delete this[i]:delete this[i].fx)}}},invertFx:{value:function(t,i){var e;if(!this[t]||!(e=this[t].fx))return;var s=e.from;e.from=e.to,e.to=s,e.time=1-e.time,e.start=Date.now()-e.duration*e.time,"linear"!==e.easing&&-1===e.easing.indexOf("easeInOut")&&(e.easing=e.easing.replace(/^ease(In|Out)/,function(t,i){return"ease"+("In"===i?"Out":"In")}));e.pos="linear"===e.easing?e.time:g[e.easing](e.time),null!=i&&(e.destroy=i)}},get:{value:function(t,i){var e={};for(var s in this)t&&s!==t&&0!==s.indexOf(t+":")||i&&!this[s].fx||(e[s]=this[s]);return e}},_start:{value:function(){null===this._rafId&&(this._rafId=window.requestAnimationFrame(this._onFrame.bind(this)))}},_onFrame:{value:function(){this._rafId=null;var t=Date.now();this._cb(this._updateFx(t)),this.clearFx(t),Object.keys(this.get(null,!0)).length>0&&this._start()}},_updateFx:{value:function(t){var i={};for(var e in this){var s=this[e].fx;s&&(void 0!==s.from&&void 0!==s.to&&(s.time=Math.max(0,Math.min(1,(t-s.start)/s.duration)),s.pos="linear"===s.easing?s.time:g[s.easing](s.time),"number"==typeof s.from&&"number"==typeof s.to&&(s.value=s.from+(s.to-s.from)*s.pos)),i[e]=this[e])}return i}}});var m=d();function x(t,i,e,s){this.eCanvas=t,this.ctx=this.eCanvas.getContext("2d"),this.xAxis=i,this.graphs=e,this.config=s,this.ctx.font=this.config.font.weight+" "+this.config.font.size*m+"px "+this.config.font.family,this.maxLabelWidth=this.getMaxLabelWidth()}function b(t,i,e,s){this.eCanvas=t,this.config=e,this.hBounds=i,this.cb=s,this.el=document.createElement("div"),this.el.className="b-tooltip",this.eParent=this.eCanvas.parentElement,this.iHover=null,this._bind()}x.prototype.getFirstLabelOffset=function(){var t=this.config.chart.margin,i=(this.eCanvas.width-t.left*m-t.right*m)/this.config.columns.min;return Math.max(1,Math.round(this.maxLabelWidth/2/i))},x.prototype.getVisibleLabelsRange=function(t){var i=this.getMinLabelPresetId(t),e=this.getFirstLabelOffset(),s=this.xAxis.length-2,n=Math.ceil(Math.max(0,this.xAxis.length-1-t.last-e)/i)*i-i+e,a=Math.floor(Math.max(0,this.xAxis.length-1-t.first-e)/i)*i+i+e;return n<0&&(n-=Math.floor(n/i)*i),a>s&&(a-=Math.ceil((a-s)/(i/2))*(i/2)),{first:n,last:a}},x.prototype.getVisibleLabels=function(t){var i=this.getVisibleLabelsRange(t);return this.createPresets(i)},x.prototype.createPresets=function(t){for(var i={},e=this.getFirstLabelOffset(),s=t.first-e,n=t.last-e,a=1;;a*=2){i[a]=[];for(var o=Math.ceil((Math.max(1,s)-a)/a/2)*a*2+a;o<=n;o+=2*a)i[a].push(o+e);if(2*a>n){0===s&&(i.first=[0+e]);break}}return i},x.prototype.getMinLabelPresetId=function(t){for(var i=this.config.chart.margin,e=(this.eCanvas.width-i.left*m-i.right*m)/(t.last-t.first),s=1;s<=1024;s*=2)if(e*s>1.75*this.maxLabelWidth)return s;return null},x.prototype.getLabel=function(t){var i=new Date(this.xAxis[this.xAxis.length-1-t]);return this.config.localization.months[i.getMonth()]+" "+i.getDate()},x.prototype.getLastLabel=function(t){var i,e,s=-1;for(var n in t){var a=t[n].length-1;t[n][a]>s&&(s=t[n][a],i=n,e=a)}return{preset:i,index:e,value:t[i][e]}},x.prototype.getDayOfWeek=function(t){var i=new Date(this.xAxis[this.xAxis.length-1-t]);return this.config.localization.days[i.getDay()]},x.prototype.getMaxLabelWidth=function(){var t=this.config.localization.months.reduce(function(t,i){return i.length>t.length?i:t},"");return this.measure(t+" 00")},x.prototype.measure=function(t){return this.ctx.measureText(t).width},b.prototype.update=function(t,i,e,s){var n="<header>".concat(e,"</header>");n+="<ul>";for(var a=0;a<s.length;a++)n+='<li style="color: '.concat(s[a].color,';"><a class="e-value" title="').concat(s[a].hint,'">').concat(s[a].text,'</a><span class="e-name">').concat(s[a].name,"</span></li>");n+="</ul>",this.el.innerHTML=n,this.el.style.opacity=i;var o=getComputedStyle(this.el),h=this.config.tooltip.offset,r=parseInt(o.marginLeft)||0,l=parseInt(o.marginRight)||0,u=Math.max(0,t-h-r);u=Math.min(u,this.eParent.clientWidth-this.el.clientWidth-l-r),this.el.style.left=u+"px",!this.el.parentElement&&i>0?this.eParent.appendChild(this.el):this.el.parentElement&&0===i&&this.eParent.removeChild(this.el)},b.prototype._bind=function(){var t=this,i=0,e=function i(){document.removeEventListener("touchmove",s),document.removeEventListener("touchend",i),null!==t.iHover&&(t.cb(null,t.iHover),t.iHover=null)},s=function(i){t._onHover(i.touches[0].pageX,i.touches[0].pageY)},n=function i(e){for(var s=e.target;null!==s;s=s.parentElement){if(s===t.eCanvas)return void t._onHover(e.pageX,e.pageY);if(s===t.eParent)return}document.removeEventListener("mousemove",i),t.eParent.addEventListener("mouseenter",a),null!==t.iHover&&(t.cb(null,t.iHover),t.iHover=null)},a=function e(){Date.now()<i+500||(t.eParent.removeEventListener("mouseenter",e),document.addEventListener("mousemove",n))};this.eParent.addEventListener("mouseenter",a),this.eCanvas.addEventListener("touchstart",function(n){i=Date.now(),1===n.touches.length?(t._onHover(n.touches[0].pageX,n.touches[0].pageY),document.addEventListener("touchmove",s),document.addEventListener("touchend",e)):e()})},b.prototype._onHover=function(t,i){var e=o(this.eCanvas),s=t-e.left,n=i-e.top,a=this.config.chart.margin,h=null;if(n>=a.top&&n<this.eCanvas.clientHeight-a.bottom){var r=(this.eCanvas.clientWidth-a.left-a.right)/(this.hBounds.last-this.hBounds.first);h=this.hBounds.first+Math.round((s-a.left)/r),h=Math.max(this.hBounds.first,Math.min(this.hBounds.last,h))}h!==this.iHover&&(this.cb(h,this.iHover),this.iHover=h)},b.prototype.getBottom=function(){var t=this.eCanvas.getBoundingClientRect();if(!this.el.parentElement)return t.height;var i=this.el.getBoundingClientRect();return i.top-t.top+i.height};var y=d();function _(t,i,e,s){this.el=t,this.el.className="b-main-chart",this.eCanvas=n(this.el,"canvas"),this.ctx=this.eCanvas.getContext("2d"),this.config=s,this._initHMargin(),this.xAxis=i,this.graphs=e,this.mask="",this.vLabelsCount=6,this.hLabels=new x(this.eCanvas,this.xAxis,this.graphs,this.config),this.state=new v(this._redraw.bind(this)),this.state.add("h-bounds"),this.state.add("v-bounds"),this.tooltip=new b(this.eCanvas,this.state["h-bounds"],this.config,this._onTooltip.bind(this)),window.addEventListener("resize",this.onResize.bind(this)),this.onResize()}_.prototype._initHMargin=function(){var t=getComputedStyle(this.el);null==this.config.chart.margin.left&&(this.config.chart.margin.left=-parseFloat(t.marginLeft)),null==this.config.chart.margin.right&&(this.config.chart.margin.right=-parseFloat(t.marginRight))},_.prototype.onResize=function(){this.eCanvas.width=this.eCanvas.clientWidth*y,this.eCanvas.height=this.eCanvas.clientHeight*y;var t=this.state["h-bounds"];t.first&&this._updateHorizontalLabelsFx(t),this.state.addFx("redraw")},_.prototype._getVisibleGraphsMask=function(){return this.graphs.reduce(function(t,i){return t+ +i.visible},"")},_.prototype.update=function(t,i){t&&(this._updateHorizontalLabelsFx(t,i),this.state["h-bounds"].first=t.first,this.state["h-bounds"].last=t.last),i&&this.state.clearFx();var e=this._getVisibleGraphsMask();this._updateVBounds(e,i),this.mask!==e&&(!i&&this._updateGraphVisibilityFx(e),this.mask=e),this.state.addFx("redraw")},_.prototype._onTooltip=function(t,i){var e="tooltip:fade",s="tooltip:position",n=this.state[e];if(null!==t)if(n){n.fx&&0===n.fx.to&&this.state.invertFx(e,!1);var a=null===i?this.state[s].index:2*this.state[s].index/3+1*i/3;this.state.addFx(s,{index:t},a,t,this.config.fx.duration,this.config.fx.easing)}else this.state.addFx(e,null,0,1,this.config.fx.duration,null,!1),this.state.add(s,{index:t});else n&&(n.fx?1===n.fx.to&&this.state.invertFx(e,!0):this.state.addFx(e,null,1,0,this.config.fx.duration,null,!0))},_.prototype._updateHorizontalLabelsFx=function(t,i){var e=this.hLabels.getMinLabelPresetId(t),s=this.hLabels.getVisibleLabels(t);if(i)for(var n in this.state.removeFx("h-labels",!0),s)n<e||this.state.add("h-labels:"+n,{preset:+n||n});else{var a=this.state["h-bounds"];if(a.minPreset!==e||Object.keys(this.hLabels.getVisibleLabels(a)).join(" ")!==Object.keys(s).join(" ")){var o=this.state.get("h-labels");for(var h in o){var r=o[h];if(r.fx)1===r.fx.to&&r.preset<e?this.state.invertFx(h,!0):0===r.fx.to&&r.preset>=e&&this.state.invertFx(h,!1);else if(r.preset<e){for(var l in o)o[l].fx&&0===o[l].fx.to&&o[l].preset<r.preset&&this.state.removeFx(l,!0);this.state.addFx(h,null,1,0,this.config.fx.duration,null,!0)}}for(var u in s){var c="h-labels:"+u;o[c]||u<e||this.state.addFx(c,{preset:+u||u},0,1,this.config.fx.duration)}}}this.state["h-bounds"].minPreset=e},_.prototype._updateVBounds=function(t,i){var e=this.state["v-bounds"],s=this._getVerticalBounds(t);!s||s.min===e.min&&s.max===e.max?this.state.removeFx("v-bounds"):(this._updateVerticalLabelsFx(s,t,i),i||this.mask===t?(e.min=s.min,e.max=s.max):this.state.addFx("v-bounds",null,{min:e.min,max:e.max},s,this.config.fx.duration,this.config.fx.easing))},_.prototype._updateVerticalLabelsFx=function(t,i,e){var s=this._getMaxVerticalLabel(t.maxValue),n="v-labels:"+s;if(e||this.mask===i)this.state.removeFx("v-labels",!0),this.state.add(n,{labels:this._getLabels(s)});else{var a=this.state.get("v-labels");for(var o in a)o!==n&&(a[o].fx?1===a[o].fx.to&&this.state.invertFx(o,!0):this.state.addFx(o,null,1,0,this.config.fx.duration,null,!0));var h=a[n];h?h.fx&&0===h.fx.to&&this.state.invertFx(n,!1):this.state.addFx(n,{labels:this._getLabels(s)},0,1,this.config.fx.duration)}},_.prototype._updateGraphVisibilityFx=function(t){for(var i=0;i<t.length;i++)if(t[i]!==this.mask[i]){var e="graph-fade:"+i;this.state[e]?this.state.invertFx(e):"1"===t[i]?this.state.addFx(e,{index:i},0,1,this.config.fx.duration,null,!0):this.state.addFx(e,{index:i},1,0,this.config.fx.duration,null,!0)}},_.prototype._redraw=function(t){this.ctx.clearRect(0,0,this.eCanvas.width,this.eCanvas.height),this._updateState(t);var i=this._getDrawData();this._drawHorizontalLabels(i),this._drawVerticalLabels(i),this._drawGraphs(t,i),this.config.chart.tails&&this._drawGraphTails(t,i),this._drawTooltipLine(t,i)},_.prototype._updateState=function(t){for(var i in t){var e=this.state[i].fx;"v-bounds"===i?(this.state[i].min=e.from.min+(e.to.min-e.from.min)*e.pos,this.state[i].max=e.from.max+(e.to.max-e.from.max)*e.pos):"tooltip:position"===i&&(this.state[i].index=e.value)}},_.prototype._getDrawData=function(){var t=this.state["h-bounds"].first,i=this.state["h-bounds"].last,e=this.config.chart.margin,s=e.top*y,n=this.eCanvas.height-e.bottom*y,a=e.left*y,o=this.eCanvas.width-e.right*y,h=this.state["v-bounds"].max,r=(h-this.state["v-bounds"].min)/(this.eCanvas.height-s-e.bottom*y),l=(this.eCanvas.width-a-e.right*y)/(i-t),u=this.config.chart.thickness.grid/2;return{first:t,last:i,margin:e,top:s,bottom:n,left:a,right:o,max:h,p3:r,step:l,po:(Math.ceil(u)-u)*y}},_.prototype._drawHorizontalLabels=function(t){var i=t.first,e=t.margin,s=t.left,n=t.bottom,a=t.step;this.ctx.font=this.config.font.weight+" "+this.config.font.size*y+"px "+this.config.font.family,this.ctx.fillStyle=r(this.config.font.color),this.ctx.textAlign="center",this.ctx.textBaseline="top";var o=this.state.get("h-labels"),h=this.hLabels.getVisibleLabelsRange(this.state["h-bounds"]),l=this.hLabels.createPresets(h),u=n+this.config.chart.labelVOffset.bottom*y,c=s+(this.xAxis.length-1-i-h.last)*a;if(l.first){var f=l.first[0],d=this.hLabels.getLabel(f),p=this.hLabels.measure(d),g=c+(h.last-f)*a;g-p/2<this.eCanvas.width&&this.state["h-bounds"].last===this.xAxis.length-1&&(g=Math.min(g,this.eCanvas.width-e.right*y*.75-p/2)),this.ctx.fillStyle=r(this.config.font.color),this.ctx.fillText(d,g,u)}var v=h.last===this.xAxis.length-2?this.hLabels.getLastLabel(l):null;if(v){var m=this.hLabels.getLabel(v.value),x=this.hLabels.measure(m),b=s+(this.xAxis.length-2-v.value)*a-x/2;b>s/y&&(this.ctx.fillStyle=r(this.config.font.color),this.ctx.fillText(m,b,u))}for(var _ in o){var w=o[_].preset;if("number"==typeof w&&l[w]){var L=o[_].fx;this.ctx.fillStyle=r(this.config.font.color,L?L.value:1);for(var M=0;M<l[w].length;M++)v&&l[w][M]===v.value||this.ctx.fillText(this.hLabels.getLabel(l[w][M]),c+(h.last-l[w][M])*a,u)}}},_.prototype._drawVerticalLabels=function(t){var i=t.top,e=t.left,s=t.right,n=t.max,a=t.p3,o=t.po;this.ctx.font=this.config.font.weight+" "+this.config.font.size*y+"px "+this.config.font.family,this.ctx.fillStyle=r(this.config.font.color),this.ctx.textAlign="start",this.ctx.textBaseline="alphabetic",this.ctx.strokeStyle=r(this.config.chart.color.hLine),this.ctx.lineWidth=this.config.chart.thickness.grid*y,this.ctx.lineCap="butt";var h=this.state.get("v-labels");this.ctx.beginPath();var l=Math.round(i+n/a);for(var u in this.ctx.moveTo(e,l-o),this.ctx.lineTo(s,l-o),this.ctx.fillText("0",e,l-this.config.chart.labelVOffset.left*y),this.ctx.stroke(),h){var c=h[u],f=c.fx?c.fx.value:1;this.ctx.strokeStyle=r(this.config.chart.color.hLine,f),this.ctx.fillStyle=r(this.config.font.color,f),this.ctx.beginPath();for(var d=1;d<c.labels.length;d++){var p=Math.round(i+(n-c.labels[d].value)/a);this.ctx.moveTo(e,p-o),this.ctx.lineTo(s,p-o),this.ctx.fillText(c.labels[d].text,e,p-this.config.chart.labelVOffset.left*y)}this.ctx.stroke()}},_.prototype._drawGraphs=function(t,i){var e=i.first,s=i.last,n=i.top,a=i.left,o=i.max,h=i.p3,l=i.step;this.ctx.lineWidth=this.config.chart.thickness.graph*y,this.ctx.lineJoin="round",this.ctx.lineCap="round";for(var u=0;u<this.graphs.length;u++){var c=t["graph-fade:"+u];if(this.graphs[u].visible||c){var f=this.graphs[u].columns;this.ctx.beginPath(),this.ctx.moveTo(a,n+(o-f[e])/h);for(var d=e+1;d<=s;d++)this.ctx.lineTo(a+(d-e)*l,n+(o-f[d])/h);this.ctx.strokeStyle=r(this.graphs[u].color,c?c.fx.value:1),this.ctx.stroke()}}},_.prototype._drawGraphTails=function(t,i){var e=i.first,s=i.last,n=i.top,a=i.left,o=i.max,h=i.p3,l=i.step;this.ctx.lineWidth=this.config.chart.thickness.graph*y,this.ctx.lineJoin="round",this.ctx.lineCap="round";for(var u=0;u<this.graphs.length;u++){var c=t["graph-fade:"+u];if(this.graphs[u].visible||c){var f=this.graphs[u].columns;this.ctx.beginPath(),this.ctx.moveTo(a,n+(o-f[e])/h);for(var d=e-1;d>=1;d--){var p=a+(d-e)*l;if(this.ctx.lineTo(p,n+(o-f[d])/h),p<0)break}this.ctx.strokeStyle=r(this.graphs[u].color,c?c.fx.value:1),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(a+(s-e)*l,n+(o-f[s])/h);for(var g=s+1;g<this.xAxis.length;g++){var v=a+(g-e)*l;if(this.ctx.lineTo(v,n+(o-f[g])/h),v>this.eCanvas.width)break}this.ctx.strokeStyle=r(this.graphs[u].color,c?c.fx.value:1),this.ctx.stroke()}}},_.prototype._drawTooltipLine=function(t,i){var e=i.top,s=i.left,n=i.bottom,a=i.first,o=i.max,h=i.p3,l=i.step,u=i.po,c=this.state["tooltip:fade"];if(c&&(0!==Object.keys(this.state.get("graph-fade")).length||-1!==this.mask.indexOf(1))){var f=this.state["tooltip:position"],d=s+(f.index-a)*l,p=c.fx?c.fx.value:1;this.ctx.lineWidth=this.config.chart.thickness.grid*y,this.ctx.lineCap="butt",this.ctx.strokeStyle=r(this.config.chart.color.vLine,p),this.ctx.moveTo(d-u,this.tooltip.getBottom()*y),this.ctx.lineTo(d-u,n),this.ctx.stroke();var g=this.config.tooltip.crossingRadius*y*p,v=this.config.chart.thickness.graph/2*y;this.ctx.lineWidth=2*v;for(var m=0;m<this.graphs.length;m++){var x=t["graph-fade:"+m];if(this.graphs[m].visible||x){var b=this.graphs[m].columns,_=f.index,w=e+(o-(_=_%1==0?b[_]:b[~~_]+(b[1+~~_]-b[~~_])*(_%1)))/h,L=(x?x.fx.value:1)*p;this.ctx.strokeStyle=r(this.graphs[m].color,L);var M=Math.max(0,Math.ceil(g-v));this.ctx.clearRect(d-M,w-M,2*M,2*M),this.ctx.beginPath(),this.ctx.arc(d,w,g,0,2*Math.PI),this.ctx.stroke()}}this._updateTooltip(f.fx?f.fx.to:~~f.index,~~(d/y),p)}},_.prototype._updateTooltip=function(t,i,e){for(var s=[],n=0;n<this.graphs.length;n++)("1"===this.mask[n]||this.state["graph-fade:"+n])&&s.push({name:this.graphs[n].name,color:r(this.graphs[n].color),text:this._valueToLabel(this.graphs[n].columns[t]),hint:this._formatValue(this.graphs[n].columns[t])});var a=this.xAxis.length-1-t,o=this.hLabels.getDayOfWeek(a)+", "+this.hLabels.getLabel(a);this.tooltip.update(i,e,o,s)},_.prototype._getLabels=function(t){for(var i=t/(this.vLabelsCount-1),e=[],s=0;s<this.vLabelsCount;s++)e.push({value:i*s,text:this._valueToLabel(i*s)});return e},_.prototype._getMaxVerticalLabel=function(t){var i=Math.max(0,(~~t).toString().length-3),e=Math.pow(10,i)*(this.vLabelsCount-1)*2;return Math.round(t/e)*e},_.prototype._valueToLabel=function(t){if(t<1e3)return(~~t).toString();var i,e=(~~t).toString().length,s=3*(Math.ceil(e/3)-1);if(e-s>1)1e3===(t=Math.round(t/Math.pow(10,s)))&&(t=1,s+=3),i=t.toString();else{i=(~~(t=Math.round(t/Math.pow(10,s-1))/10)).toString();var n=Math.round(t%1*10).toString();"0"!==n&&(i+=this.config.localization.separator.decimal+n)}return i+this.config.localization.suffixes[s/3-1]},_.prototype._formatValue=function(t){return t.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1"+this.config.localization.separator.thousand)},_.prototype._getVerticalBounds=function(t){if(-1===t.indexOf("1"))return null;var i=this._getMinValue(t),e=this._getMaxValue(t),s=this.config.chart.margin,n=(e-i)/(this.eCanvas.height-s.top*y-s.bottom*y),a=this._getMaxVerticalLabel(e),o=this.config.font.size*this.config.font.hLetter*y,h=this.config.chart.labelVOffset.left*y,r=(a-i)/(this.eCanvas.height-s.top*y-s.bottom*y-o-h);return{min:i,max:n>r?e:a+(o+h)*r,maxValue:e}},_.prototype._getMinValue=function(){return 0},_.prototype._getMaxValue=function(t){var i=this;return this.graphs.reduce(function(e,s,n){if("0"===t[n])return e;var a=s.columns.slice(i.state["h-bounds"].first,i.state["h-bounds"].last+1);return Math.max(e,Math.max.apply(null,a))},Number.NEGATIVE_INFINITY)};var w=d();function L(t,i,e){this.el=t,this.el.className="b-mini-chart",this.eCanvas=n(this.el,"canvas"),this.ctx=this.eCanvas.getContext("2d"),this.config=e,this.graphs=i,this.mask="",this.state=new v(this._redraw.bind(this)),this.state.add("h-bounds"),this.state.add("v-bounds"),this.update({first:1,last:this.graphs[0].columns.length-1},!0),window.addEventListener("resize",this.onResize.bind(this)),this.onResize()}function M(t,i,e){var s=this;this.el=t,this.el.classList.add("b-chart-preview"),this.graphs=i,this.config=e,this.bounds={first:-1,last:-1},this.chart=new L(n(this.el,"div"),this.graphs,this.config),this.eHandle=n(this.el,"div","d-handle"),this.eLeftEdge=n(this.eHandle,"span","e-edge m-left"),this.eRightEdge=n(this.eHandle,"span","e-edge m-right"),a(this.el,this._onDrag.bind(this)),a(this.eHandle,this._onHandleDrag.bind(this)),a(this.eLeftEdge,this._onLeftDrag.bind(this)),a(this.eRightEdge,this._onRightDrag.bind(this)),window.addEventListener("resize",function(){s._initData()}),this._initData(!0)}function C(t,i,e,s){var n=this;this.el=t,this.el.classList.add("b-check-button"),this._initChildren(i,e),this.state=s,this.toggleState(this.state,!0),this.el.addEventListener("click",function(){n.toggleState()})}function k(t,i,e){if(this.el=t,this.el.classList.add("b-chart-widget"),this.config=u({},p,e),this.config.columns.min=parseInt(this.el.getAttribute("min-columns"))||this.config.columns.min,this.config.columns.max=parseInt(this.el.getAttribute("max-columns"))||this.config.columns.max,document.fonts){var s=this.config.font;document.fonts.load("".concat(s.weight," ").concat(s.size,"px ").concat(s.family)).then(this._initAll.bind(this,i))}else this._initAll(i)}L.prototype.onResize=function(){this.eCanvas.width=this.eCanvas.clientWidth*w,this.eCanvas.height=this.eCanvas.clientHeight*w,this.state.addFx("redraw")},L.prototype._getVisibleGraphsMask=function(){return this.graphs.reduce(function(t,i){return t+ +i.visible},"")},L.prototype.update=function(t,i){t&&(this.state["h-bounds"].first=t.first,this.state["h-bounds"].last=t.last),i&&this.state.clearFx();var e=this._getVisibleGraphsMask();this._updateVBounds(e,i),this.mask!==e&&(!i&&this._updateGraphVisibilityFx(e),this.mask=e),this.state.addFx("redraw")},L.prototype._updateVBounds=function(t,i){var e=this.state["v-bounds"],s=this._getVerticalBounds(t);!s||s.min===e.min&&s.max===e.max?this.state.removeFx("v-bounds"):i||-1===this.mask.indexOf("1")||this.mask===t?(e.min=s.min,e.max=s.max):this.state.addFx("v-bounds",null,{min:e.min,max:e.max},s,this.config.fx.duration,this.config.fx.easing)},L.prototype._updateGraphVisibilityFx=function(t){for(var i=0;i<t.length;i++)if(t[i]!==this.mask[i]){var e="graph-fade:"+i;this.state[e]?this.state.invertFx(e):"1"===t[i]?this.state.addFx(e,{index:i},-1,1,this.config.fx.duration,null,!0):this.state.addFx(e,{index:i},1,-1,this.config.fx.duration,null,!0)}},L.prototype._redraw=function(t){this._updateState(t);var i=this.state["h-bounds"].first,e=this.state["h-bounds"].last,s=this.state["v-bounds"].max,n=this.config.preview.margin*w,a=(s-this.state["v-bounds"].min)/(this.eCanvas.height-2*n),o=this.eCanvas.width/(e-i);this.ctx.clearRect(0,0,this.eCanvas.width,this.eCanvas.height),this.ctx.lineWidth=this.config.preview.thickness*w,this.ctx.lineJoin="round",this.ctx.lineCap="square";for(var h=0;h<this.graphs.length;h++){var l=t["graph-fade:"+h];if(this.graphs[h].visible||l){var u=this.graphs[h].columns;this.ctx.beginPath(),this.ctx.moveTo(0,n+(s-u[i])/a);for(var c=i+1;c<=e;c++)this.ctx.lineTo((c-i)*o,n+(s-u[c])/a);this.ctx.strokeStyle=r(this.graphs[h].color,l?Math.max(0,l.fx.value):1),this.ctx.stroke()}}},L.prototype._updateState=function(t){for(var i in t){var e=t[i].fx;"v-bounds"===i&&(t[i].min=e.from.min+(e.to.min-e.from.min)*e.pos,t[i].max=e.from.max+(e.to.max-e.from.max)*e.pos)}},L.prototype._getVerticalBounds=function(t){return-1===t.indexOf("1")?null:{min:this._getMinValue(t),max:this._getMaxValue(t)}},L.prototype._getMinValue=function(t){var i=this;return this.graphs.reduce(function(e,s,n){if("0"===t[n])return e;var a=s.columns.slice(i.state["h-bounds"].first,i.state["h-bounds"].last+1);return Math.min(e,Math.min.apply(null,a))},Number.POSITIVE_INFINITY)},L.prototype._getMaxValue=function(t){var i=this;return this.graphs.reduce(function(e,s,n){if("0"===t[n])return e;var a=s.columns.slice(i.state["h-bounds"].first,i.state["h-bounds"].last+1);return Math.max(e,Math.max.apply(null,a))},Number.NEGATIVE_INFINITY)},M.prototype._initData=function(t){var i=this.config.columns,e=this.el.clientWidth,s=i.adaptive?e/i.adaptive:1,n=1/(this.graphs[0].columns.length-2);this.minWidth=Math.min(1,~~((i.min-1)*s)*n),this.maxWidth=!i.max||i.max<i.min?1:Math.min(1,~~((i.max-1)*s)*n),null!=this.width?this.width=Math.max(this.minWidth,Math.min(this.maxWidth,this.width)):this.width=!i.end||i.end<i.start?this.minWidth:Math.min(1,Math.max(this.minWidth,(i.end-i.start)*n)),this.pos=Math.max(0,1-this.width-i.start*n),this._updateHandle(t)},M.prototype._updateHandle=function(t){this.eHandle.style.left=100*this.pos+"%",this.eHandle.style.right=100*(1-this.pos-this.width)+"%";var i=this._getBounds();if(i.first===i.last)throw"Invalid Environment";t||i.first===this.bounds.first&&i.last===this.bounds.last||this.el.dispatchEvent(new CustomEvent("new-bounds",{bubbles:!0,detail:i})),this.bounds=i},M.prototype._getBounds=function(){var t=this.graphs[0].columns.length-2;return{first:Math.round(t*this.pos)+1,last:Math.round(t*(this.pos+this.width))+1}},M.prototype._onDrag=function(t,i){var e=this.el.clientWidth,s=o(this.el).left,n=(i.x-s)/e-this.width/2;this.pos=Math.max(0,Math.min(1-this.width,n)),this._updateHandle()},M.prototype._onHandleDrag=function(t,i){var e=this.el.clientWidth,s=o(this.el).left,n=(i.x-s-i.ox)/e;this.pos=Math.max(0,Math.min(1-this.width,n)),this._updateHandle()},M.prototype._onLeftDrag=function(t,i){var e=this.el.clientWidth,s=o(this.el).left,n=this.pos+this.width,a=(i.x-s-i.ox)/e;this.pos=Math.max(0,n-this.maxWidth,Math.min(n-this.minWidth,a)),this.width=n-this.pos,this._updateHandle()},M.prototype._onRightDrag=function(t,i){var e=this.el.clientWidth,s=o(this.el).left,n=this.eRightEdge.clientWidth-i.ox,a=(i.x-s+n)/e-this.pos;this.width=Math.max(this.minWidth,Math.min(1-this.pos,this.maxWidth,a)),this._updateHandle()},C.prototype._initChildren=function(t,i){this.eIcon=n(this.el,"i","e-icon"),this.eIcon.style.cssText="border-color: ".concat(i,";"),n(this.el,"span","e-label").textContent=t},C.prototype.toggleState=function(t,i){this.state=void 0!==t?t:!this.state,this.state?(this.el.classList.add("m-checked"),this.el.classList.remove("m-unchecked")):(this.el.classList.remove("m-checked"),this.el.classList.add("m-unchecked")),i||this.el.dispatchEvent(new CustomEvent("check",{bubbles:!0,detail:{checked:this.state}}))},e.d(i,"ChartWidget",function(){return k}),window.ChartWidget=k,k.prototype._initAll=function(t){/Android|iPad|iPhone|Windows Phone/.test(window.navigator.userAgent)&&this.el.classList.add("m-mobile"),this._normalizeColors(),this._initialize(t),this._initPreview(),this._initLegend(),this._initMainChart(),this.main.update(this.preview.bounds,!0)},k.prototype._initialize=function(t){var i=this,e=this.config.visible;this.graphs=[];var s=function(s){"x"===t.types[s]?i.xAxis=f(t.columns,function(t){return t[0]===s}):i.graphs.push({name:t.names[s],color:h(t.colors[s]),columns:f(t.columns,function(t){return t[0]===s}),visible:!e||void 0===e[s]||e[s]})};for(var n in t.types)s(n)},k.prototype._initMainChart=function(){var t=function(t,i,e){if(null===t.firstChild)return n(t,i,e);var s=document.createElement(i);return s.className=e||"",t.insertBefore(s,t.firstChild)}(this.el,"div");this.main=new _(t,this.xAxis,this.graphs,this.config)},k.prototype._initPreview=function(){var t=this,i=n(this.el,"div");this.preview=new M(i,this.graphs,this.config),this.preview.el.addEventListener("new-bounds",function(i){t.main.update(i.detail)})},k.prototype._initLegend=function(){var t=n(this.el,"ul","d-legend");this.legend=[];for(var i=0;i<this.graphs.length;i++){var e=n(t,"li");this.legend.push(new C(e,this.graphs[i].name,r(this.graphs[i].color),this.graphs[i].visible)),this.legend[i].el.addEventListener("check",this._onButtonCheck.bind(this,i))}},k.prototype._onButtonCheck=function(t,i){this.graphs[t].visible=i.detail.checked,this.preview.chart.update(),this.main.update()},k.prototype._normalizeColors=function(){this.config.font.color=h(this.config.font.color),this.config.chart.color.hLine=h(this.config.chart.color.hLine),this.config.chart.color.vLine=h(this.config.chart.color.vLine)}}]);